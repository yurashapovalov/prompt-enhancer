# Prompt Enhancer

Приложение для улучшения промптов с использованием переменных и шаблонов.

## Структура проекта

- `backend/` - Бэкенд на FastAPI с Firebase
- `frontend/` - Фронтенд (Chrome-расширение и веб-приложение)

## Оптимизации производительности

В приложение внесены следующие оптимизации для улучшения производительности:

### Бэкенд

- **Кэширование данных**: Добавлено кэширование запросов к Firebase для уменьшения нагрузки на базу данных
- **Оптимизация запросов**: Улучшены запросы к Firestore с использованием ограничений и сортировки
- **Многопроцессорная обработка**: Настроен uvicorn для работы с несколькими рабочими процессами
- **Логирование**: Оптимизировано логирование с фокусом только на важных событиях
- **Мониторинг производительности**: Добавлен middleware для отслеживания медленных запросов
- **Кэширование токенов**: Добавлено кэширование токенов аутентификации

### Фронтенд

- **Оптимизация установки зависимостей**: Добавлено кэширование хэшей package.json для ускорения запуска
- **Очистка кэша Vite**: Автоматическая очистка кэша Vite перед запуском для предотвращения проблем
- **Оптимизированные настройки запуска**: Добавлены переменные окружения для ускорения работы Vite

### Общие улучшения

- **Умный запуск**: Скрипты теперь проверяют, нужно ли устанавливать зависимости, что ускоряет запуск
- **Проверка портов**: Добавлена проверка доступности портов перед запуском
- **Корректное завершение**: Улучшена обработка сигналов для корректного завершения работы приложения
- **Информативные сообщения**: Добавлены более подробные сообщения о статусе запуска

## Запуск приложения

### Простой способ (рекомендуется)

Для запуска всего приложения (бэкенд и фронтенд) используйте:

```bash
./start_app.sh
```

Этот скрипт автоматически:
1. Проверит доступность портов
2. Запустит бэкенд и фронтенд
3. Установит все необходимые зависимости, если они отсутствуют
4. Проверит успешность запуска компонентов
5. Выведет URL для доступа к приложению

### Запуск компонентов по отдельности

#### Запуск бэкенда

```bash
cd backend
./start_backend.sh
```

Скрипт автоматически:
1. Создаст виртуальное окружение Python, если оно отсутствует
2. Установит все необходимые зависимости (только если они изменились)
3. Очистит кэш Python для предотвращения проблем
4. Запустит бэкенд на порту 8000 с оптимизированными настройками

#### Запуск фронтенда

```bash
cd frontend/chrome-extension
./start_frontend.sh
```

Скрипт автоматически:
1. Установит npm-зависимости, если они отсутствуют или изменились
2. Очистит кэш Vite перед запуском
3. Запустит фронтенд в режиме разработки с оптимизированными настройками

## Решение проблем

### Бэкенд не запускается

Если бэкенд не запускается, проверьте:

1. Наличие файла сервисного аккаунта Firebase в директории `backend/`
2. Логи в файле `backend/server_log.txt`
3. Установлены ли все зависимости:
   ```bash
   cd backend
   source venv/bin/activate
   pip install -r requirements.txt
   pip install firebase-admin
   ```

### Фронтенд не запускается

Если фронтенд не запускается, проверьте:

1. Установлены ли все зависимости:
   ```bash
   cd frontend/chrome-extension
   npm install
   ```
2. Правильно ли настроен файл конфигурации Firebase в `frontend/shared/firebase-config.js`
3. Попробуйте очистить кэш Vite вручную:
   ```bash
   rm -rf frontend/chrome-extension/node_modules/.vite
   ```

### Проблемы с соединением

Убедитесь, что:
1. Бэкенд запущен и доступен по адресу `http://localhost:8000`
2. В файле `frontend/shared/firebase-config.js` указан правильный URL API
3. Порты 8000 и 5173 не заняты другими приложениями

### Проблемы с производительностью

Если приложение всё ещё работает медленно:
1. Проверьте логи медленных запросов в `backend/server_log.txt`
2. Убедитесь, что у вас достаточно оперативной памяти для запуска приложения
3. Проверьте соединение с интернетом, так как Firebase требует стабильного подключения
