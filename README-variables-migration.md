# Миграция переменных в промпты (Завершено)

> **Примечание**: Миграция полностью завершена. Все упоминания о переменных как отдельных сущностях удалены из кода. Для запуска приложения используйте скрипт `./start_app.sh`.

## Что было сделано

1. **Обновлена модель данных**
   - Добавлен класс `PromptVariable` в `backend/models.py`
   - Обновлен класс `Prompt` для хранения переменных внутри промптов

2. **Обновлен фронтенд**
   - Улучшена обработка переменных в `InputBlockContent` для более надежного обнаружения
   - Удалена вкладка Variables из навигации
   - Обновлен компонент `PromptDetail` для работы с переменными внутри промптов

3. **Миграция выполнена и завершена**
   - Скрипты миграции были созданы, использованы и удалены после завершения миграции

## Выполненные задачи миграции

1. **Миграция данных**
   - ✅ Перенесены переменные из коллекции variables в коллекцию prompts
   - ✅ Проверено, что все переменные успешно перенесены
   - ✅ Удалена коллекция variables из Firestore

2. **Удален устаревший код**
   - ✅ Удалены API-эндпоинты для переменных в `backend/routers/variables.py`
   - ✅ Удален репозиторий переменных в `backend/firebase/repositories/variables.py`
   - ✅ Удалены компоненты для работы с переменными в `frontend/chrome-extension/src/layout/main-layout/components/tabs-content/variables-tab/`
   - ✅ Обновлены импорты в файле `backend/firebase/__init__.py`
   - ✅ Удален скрипт `start_app_new.sh`, оставлен только `start_app.sh`
   - ✅ Удалены скрипты миграции `backend/migrate_variables_to_prompts.py` и `backend/migrate_variables.sh`

## Процесс миграции (архивная информация)

> **Примечание**: Миграция полностью завершена, скрипты миграции удалены. Эта информация сохранена только для истории.

Миграция была выполнена с помощью специальных скриптов, которые:
1. Получали все переменные пользователя из коллекции `variables`
2. Для каждой переменной создавали соответствующий промпт в коллекции `prompts`
3. Копировали значение переменной в текст промпта
4. Устанавливали имя переменной как имя промпта
5. После успешной миграции удаляли переменные из коллекции `variables`

## Архитектура после миграции

### Было:
- Промпты хранились в коллекции `prompts`
- Переменные хранились в коллекции `variables`
- Переменные были отдельными сущностями, не связанными напрямую с промптами
- Для работы с переменными была отдельная вкладка в интерфейсе

### Стало:
- Промпты хранятся в коллекции `prompts`
- Переменные хранятся внутри промптов в поле `variables`
- Каждый промпт содержит только те переменные, которые используются в его тексте
- Вкладка переменных удалена из интерфейса
